<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Formulário de Envio</title>
</head>
<body>
  <h1>Enviar Dados para Google Sheets</h1>

  <form id="meuFormulario">
    <input id="data" placeholder="Data"><br>
    <input id="estaca" placeholder="Estaca"><br>
    <input id="pano" placeholder="Pano"><br>
    <input id="altura" placeholder="Altura"><br>
    <input id="inclinacao" placeholder="Inclinação"><br>
    <input id="camada" placeholder="Camada"><br>
    <input id="folga" placeholder="Folga"><br>
    <input id="ladoBaixo" placeholder="Lado Baixo"><br>
    <input id="ladoAlto" placeholder="Lado Alto"><br>
    <input id="diferencaCota" placeholder="Diferença Cota"><br>
    <input id="novaAltura" placeholder="Nova Altura"><br>
    <input id="novaDist" placeholder="Nova Distância"><br>
    <input id="distFinal" placeholder="Distância Final"><br>
    <input id="valorLadoBaixo" placeholder="Valor Lado Baixo"><br>
    <input id="valorLadoAlto" placeholder="Valor Lado Alto"><br>
    <button type="submit">Enviar</button>
  </form>

  <script>
    const form = document.getElementById('meuFormulario');

    form.addEventListener('submit', async (event) => {
      event.preventDefault(); // evita recarregar a página

      // Monta os dados a enviar
      const dados = {
        data: document.getElementById("data").value,
        estaca: document.getElementById("estaca").value,
        pano: document.getElementById("pano").value,
        altura: document.getElementById("altura").value,
        inclinacao: document.getElementById("inclinacao").value,
        camada: document.getElementById("camada").value,
        folga: document.getElementById("folga").value,
        ladoBaixo: document.getElementById("ladoBaixo").value,
        ladoAlto: document.getElementById("ladoAlto").value,
        diferencaCota: document.getElementById("diferencaCota").value,
        novaAltura: document.getElementById("novaAltura").value,
        novaDist: document.getElementById("novaDist").value,
        distFinal: document.getElementById("distFinal").value,
        valorLadoBaixo: document.getElementById("valorLadoBaixo").value,
        valorLadoAlto: document.getElementById("valorLadoAlto").value
      };

      try {
        // ======= SUBSTITUA AQUI PELO LINK DO SEU WEB APP =======
        const WEB_APP_URL = "https://script.google.com/macros/s/AKfycbwxKkZO6-PP-gqgMokxmhwtJ6b63RyX3e1JJ1RHVfxrP1K8VjP7wGAS5IJq-Aiwu2Mj/exec";

        const response = await fetch(WEB_APP_URL, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(dados)
        });

        const texto = await response.text();
        alert("Resposta do servidor: " + texto);
      } catch (err) {
        alert("Erro ao enviar dados: " + err.message);
      }
    });
  </script>
</body>
</html>
